<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>AWS Chaliceを使ってサーバレスアプリケーションを開発しよう &#183; クラウドCoEの何でも屋</title><meta name=title content="AWS Chaliceを使ってサーバレスアプリケーションを開発しよう &#183; クラウドCoEの何でも屋"><link rel=canonical href=https://chacco38.github.io/posts/2021/10/aws-chalice/><link type=text/css rel=stylesheet href=/css/main.bundle.min.fe92cefeb86e1cd65b82d4143fbb9f1dd28e4e3cd5990d2ed6dff3db6bd5253228486521e25088b229d2457d24c5c9337e29093b8d10d3c3f9cd6174596f8042.css integrity="sha512-/pLO/rhuHNZbgtQUP7ufHdKOTjzVmQ0u1t/z22vVJTIoSGUh4lCIsinSRX0kxckzfikJO40Q08P5zWF0WW+AQg=="><script type=text/javascript src=/js/appearance.min.12e98742cd283574d030a7fe55f29597df4ee214f7ff7075b4d19a64d046a602753c715295550be7899b661619cec89c679049d36c624681671a8013c1249896.js integrity="sha512-EumHQs0oNXTQMKf+VfKVl99O4hT3/3B1tNGaZNBGpgJ1PHFSlVUL54mbZhYZzsicZ5BJ02xiRoFnGoATwSSYlg=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.998bd658c4cc3498df01180704ad0ea16bb3c0d6d118eb8ac6f557a59c86d1304d69e51ba7df5a9d203e2698d28571a422b4cf20f830810d571fee19fbcb55fc.js integrity="sha512-mYvWWMTMNJjfARgHBK0OoWuzwNbRGOuKxvVXpZyG0TBNaeUbp99anSA+JpjShXGkIrTPIPgwgQ1XH+4Z+8tV/A==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="AWS Chaliceを使ってサーバレスアプリケーションを開発しよう"><meta property="og:description" content="みなさん、こんにちは。今回は「AWS Chalice」を活用したサーバレスアプリケーション開発についてのお話です。AWS Summit Online Japan 2021 の日立製作所の講演で軽く触れたこともあり、どこかで紹介したいと思っておりました。"><meta property="og:type" content="article"><meta property="og:url" content="https://chacco38.github.io/posts/2021/10/aws-chalice/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-10-18T00:00:00+09:00"><meta property="article:modified_time" content="2021-10-18T00:00:00+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="AWS Chaliceを使ってサーバレスアプリケーションを開発しよう"><meta name=twitter:description content="みなさん、こんにちは。今回は「AWS Chalice」を活用したサーバレスアプリケーション開発についてのお話です。AWS Summit Online Japan 2021 の日立製作所の講演で軽く触れたこともあり、どこかで紹介したいと思っておりました。"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"AWS Chaliceを使ってサーバレスアプリケーションを開発しよう","headline":"AWS Chaliceを使ってサーバレスアプリケーションを開発しよう","abstract":"みなさん、こんにちは。今回は「AWS Chalice」を活用したサーバレスアプリケーション開発についてのお話です。AWS Summit Online Japan 2021 の日立製作所の講演で軽く触れたこともあり、どこかで紹介したいと思っておりました。","url":"https:\/\/chacco38.github.io\/posts\/2021\/10\/aws-chalice\/","author":{"@type":"Person","name":"クラウドCoEの何でも屋"},"copyrightYear":"2021","dateCreated":"2021-10-18T00:00:00\u002b09:00","datePublished":"2021-10-18T00:00:00\u002b09:00","dateModified":"2021-10-18T00:00:00\u002b09:00","keywords":["AWS","AWS Chalice","AWS Lambda","AWS CloudFormation","AWS CodePipeline"],"mainEntityOfPage":"true","wordCount":"1071"}]</script><meta name=generator content="Hugo 0.96.0"><meta name=author content="クラウドCoEの何でも屋"><link href=https://github.com/chacco38 rel=me><link href=https://twitter.com/chacco38 rel=me><link href=https://www.facebook.com/satoshi.matsuzawa.9 rel=me><link href=https://www.linkedin.com/in/satoshi-matsuzawa-b209a1157 rel=me><script async src="https://www.googletagmanager.com/gtag/js?id=G-BXXYM9R5MV"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-BXXYM9R5MV",{anonymize_ip:!1})}</script></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="flex justify-between py-6 font-semibold sm:items-center sm:py-10 text-neutral-900 dark:text-neutral"><div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>クラウドCoEの何でも屋</a></div><nav><ul class="flex flex-col list-none sm:flex-row"><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/posts/ title=Posts>Blog</a></li><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>Tags</a></li><li class="ltr:text-right rtl:text-left ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><button id=search-button class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button></li></ul></nav></header><main id=main-content class="relative grow"><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400"><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/>クラウドCoEの何でも屋</a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class="inline hidden"><a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href=/posts/2021/10/aws-chalice/>AWS Chaliceを使ってサーバレスアプリケーションを開発しよう</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">AWS Chaliceを使ってサーバレスアプリケーションを開発しよう</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400"><div class="flex flex-row flex-wrap items-center"><time datetime="2021-10-18 00:00:00 +0900 +0900">October 18, 2021</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">6 mins</span></div><div class="my-1 text-xs text-neutral-500 dark:text-neutral-400"><a href=/tags/aws/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">AWS</a>
<a href=/tags/aws-chalice/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">AWS Chalice</a>
<a href=/tags/aws-lambda/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">AWS Lambda</a>
<a href=/tags/aws-cloudformation/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">AWS CloudFormation</a>
<a href=/tags/aws-codepipeline/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">AWS CodePipeline</a></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last"><div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10"><details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 lg:mt-3"><summary class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700">Table of Contents</summary><div class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#aws-chalice-とは>AWS Chalice とは</a></li><li><a href=#aws-chalice-を使ってみよう>AWS Chalice を使ってみよう</a><ul><li><a href=#まずは開発環境の構築から>まずは開発環境の構築から</a></li><li><a href=#簡単なアプリケーションを動かしてみよう>簡単なアプリケーションを動かしてみよう</a></li><li><a href=#ユニットテストを自動化しよう>ユニットテストを自動化しよう</a></li><li><a href=#cicd-パイプラインを構築しよう>CI/CD パイプラインを構築しよう</a></li></ul></li><li><a href=#ちゃんとしたアプリケーションを開発するには>ちゃんとしたアプリケーションを開発するには</a><ul><li><a href=#公式ドキュメントを活用しよう>公式ドキュメントを活用しよう</a></li><li><a href=#サービス別資料を参考にしよう>サービス別資料を参考にしよう</a></li></ul></li><li><a href=#余談ですが>余談ですが、、、</a></li><li><a href=#終わりに>終わりに</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><p>みなさん、こんにちは。今回は「AWS Chalice」を活用したサーバレスアプリケーション開発についてのお話です。AWS Summit Online Japan 2021 の日立製作所の講演で軽く触れたこともあり、どこかで紹介したいと思っておりました。</p><p>さて、AWS Chalice は多くの方にとってあまり馴染みのないツールだと思いますが、実際に使ってみるととても手軽に Amazon API Gateway と AWS Lambda を使用するサーバレスアプリケーションを作成してデプロイできます。もちろん、どんなツールにも得手不得手はあるので「すべてのプロジェクトで AWS Chalice の活用が最適か？」と言われればもちろん「No！」なのですが、ちょっと試しに動く Web API をサッと手軽に作りたい、といったケースにはとても良いソリューションだと思います。</p><p>今回は AWS CloudShell 上に開発環境を作るところからはじめて、簡素なサンプルを用いた一連の開発の流れ、テスト自動化を組み込んだシンプルな CI/CD パイプラインの構築まで紹介していきたいと思います。これから実際に動くサーバレスアプリケーションを手軽に作りたいと思われている方は参考にしてみてはいかがでしょうか。</p><h2 id=aws-chalice-とは class="relative group">AWS Chalice とは <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#aws-chalice-%e3%81%a8%e3%81%af aria-label=Anchor>#</a></span></h2><p>AWS Chalice とは、Amazon AWS Gateway や AWS Lambda を用いたサーバレスアプリケーションを、お手軽に開発できるようにする Python 製のサーバレスアプリケーションフレームワークです。具体的には、Web API をシンプルで直感的なコードで実装できるようにする機能や、作成したコードからアプリケーションの作成やデプロイを実行するコマンドラインインタフェース(CLI)といった開発者にやさしい機能を提供してくれます。</p><p>普段から Python に触れている方であれば似たような機能として <a href=https://flask.palletsprojects.com/>Flask</a> や <a href=https://bottlepy.org/>Bottle</a> をイメージされるかと思いますが、これらにサーバレス環境へデプロイする機能が追加で付与されたものが AWS Chalice、とイメージしていただくと良いのかなと思います。</p><iframe class=hatenablogcard style=width:100%;height:155px;max-width:680px src="https://hatenablog-parts.com/embed?url=https://github.com/aws/chalice" frameborder=0 scrolling=no></iframe><h2 id=aws-chalice-を使ってみよう class="relative group">AWS Chalice を使ってみよう <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#aws-chalice-%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%81%bf%e3%82%88%e3%81%86 aria-label=Anchor>#</a></span></h2><p>冒頭ですでに述べたとおり、今回は AWS CloudShell 上に開発環境を作るところからはじめて、簡素なサンプルを用いた一連の開発の流れ、テスト自動化を組み込んだシンプルな CI/CD パイプラインの構築まで紹介していきたいと思います。</p><h3 id=まずは開発環境の構築から class="relative group">まずは開発環境の構築から <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e3%81%be%e3%81%9a%e3%81%af%e9%96%8b%e7%99%ba%e7%92%b0%e5%a2%83%e3%81%ae%e6%a7%8b%e7%af%89%e3%81%8b%e3%82%89 aria-label=Anchor>#</a></span></h3><p>今回は AWS CloudShell 上に開発環境を作っていきたいと思います。
それではまず AWS Chalice をインストールする事前準備として Python の仮想環境を作成していきましょう。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo yum install -y python3
</span></span><span class=line><span class=cl>$ python3 --version
</span></span><span class=line><span class=cl>Python 3.7.10
</span></span><span class=line><span class=cl>$ python3 -m venv venv37
</span></span><span class=line><span class=cl>$ . venv37/bin/activate
</span></span></code></pre></div><p>次に、AWS Chalice をインストールします。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ python3 -m pip install chalice
</span></span><span class=line><span class=cl>$ chalice --version
</span></span><span class=line><span class=cl>chalice 1.26.0, python 3.7.10, linux 4.14.243-185.433.amzn2.x86_64
</span></span></code></pre></div><p>最後に、AWS CLI の設定をして開発環境の構築は完了です。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ aws configure
</span></span></code></pre></div><h3 id=簡単なアプリケーションを動かしてみよう class="relative group">簡単なアプリケーションを動かしてみよう <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e7%b0%a1%e5%8d%98%e3%81%aa%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%82%92%e5%8b%95%e3%81%8b%e3%81%97%e3%81%a6%e3%81%bf%e3%82%88%e3%81%86 aria-label=Anchor>#</a></span></h3><p>ここでは AWS Chalice を使ったアプリケーションの作成からデプロイまでの流れを、次のような簡単なサンプルを用いて紹介していきたいと思います。</p><p><figure><img class="my-0 rounded-md" srcset="/posts/2021/10/aws-chalice/images/01-sample-image.drawio_hu938b2bcf2a52153e61221ffedc394833_15161_330x0_resize_box_3.png 330w,
/posts/2021/10/aws-chalice/images/01-sample-image.drawio_hu938b2bcf2a52153e61221ffedc394833_15161_660x0_resize_box_3.png 660w,
/posts/2021/10/aws-chalice/images/01-sample-image.drawio_hu938b2bcf2a52153e61221ffedc394833_15161_1024x0_resize_box_3.png 1024w,
/posts/2021/10/aws-chalice/images/01-sample-image.drawio_hu938b2bcf2a52153e61221ffedc394833_15161_1320x0_resize_box_3.png 2x" src=/posts/2021/10/aws-chalice/images/01-sample-image.drawio_hu938b2bcf2a52153e61221ffedc394833_15161_660x0_resize_box_3.png alt=01-sample-image.drawio.png></figure></p><h4 id=step1-新規プロジェクトの作成 class="relative group">Step1. 新規プロジェクトの作成 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#step1-%e6%96%b0%e8%a6%8f%e3%83%97%e3%83%ad%e3%82%b8%e3%82%a7%e3%82%af%e3%83%88%e3%81%ae%e4%bd%9c%e6%88%90 aria-label=Anchor>#</a></span></h4><p>まずは <code>chalice new-project</code> コマンドを実行して新しいプロジェクトを作成します。出力例のようにプロジェクトを新しく作るとデフォルトでサンプルプログラムも生成されます。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ chalice new-project &lt;任意のプロジェクト名&gt;
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> &lt;任意のプロジェクト名&gt;
</span></span><span class=line><span class=cl>$ tree -a
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── app.py               <span class=c1># APIの実装を行うファイル</span>
</span></span><span class=line><span class=cl>├── .chalice
</span></span><span class=line><span class=cl>│   └── config.json      <span class=c1># Chaliceの設定を行うファイル</span>
</span></span><span class=line><span class=cl>├── .gitignore
</span></span><span class=line><span class=cl>└── requirements.txt     <span class=c1># 利用するライブラリの定義を行うファイル</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>1</span> directory, <span class=m>4</span> file
</span></span></code></pre></div><h4 id=step2-ソースコードの編集 class="relative group">Step2. ソースコードの編集 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#step2-%e3%82%bd%e3%83%bc%e3%82%b9%e3%82%b3%e3%83%bc%e3%83%89%e3%81%ae%e7%b7%a8%e9%9b%86 aria-label=Anchor>#</a></span></h4><p>今回はデフォルトで作られたソースコードにちょっとだけ手を加えました。修正後のファイルの中身は次の通りです。実際の例を見ていただけるとわかる通り、AWS Chalice を用いた実装は Python を普段使わないという方でも直感的でわかりやすい構文になっているのではないでしょうか。</p><p><strong>作成例）app.py</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python:app.py data-lang=python:app.py><span class=line><span class=cl><span class=kn>from</span> <span class=nn>chalice</span> <span class=kn>import</span> <span class=n>Chalice</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Chalice</span><span class=p>(</span><span class=n>app_name</span><span class=o>=</span><span class=s1>&#39;&lt;任意のプロジェクト名&gt;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=n>logging</span><span class=o>.</span><span class=n>INFO</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/hello&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hello</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&#34;Invoking from function hello&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;hello&#39;</span><span class=p>:</span> <span class=s1>&#39;world&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app</span><span class=o>.</span><span class=n>route</span><span class=p>(</span><span class=s1>&#39;/hello&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>],</span> <span class=n>content_types</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;application/json&#39;</span><span class=p>],</span> <span class=n>cors</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hello_post</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>log</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s2>&#34;Invoking from function hello_post&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span> <span class=o>=</span> <span class=n>app</span><span class=o>.</span><span class=n>current_request</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;result&#39;</span><span class=p>:</span> <span class=n>request</span><span class=o>.</span><span class=n>json_body</span><span class=p>[</span><span class=s1>&#39;payload&#39;</span><span class=p>]}</span>
</span></span></code></pre></div><p><strong>作成例）requirements.txt</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text:requirements.txt data-lang=text:requirements.txt><span class=line><span class=cl>chalice
</span></span></code></pre></div><p><strong>作成例）.chalice/config.json</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json:.chalice/config.json data-lang=json:.chalice/config.json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;2.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;app_name&#34;</span><span class=p>:</span> <span class=s2>&#34;&lt;任意のプロジェクト名&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;stages&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;dev&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;api_gateway_stage&#34;</span><span class=p>:</span> <span class=s2>&#34;api&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=step3-ローカル環境で動作確認 class="relative group">Step3. ローカル環境で動作確認 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#step3-%e3%83%ad%e3%83%bc%e3%82%ab%e3%83%ab%e7%92%b0%e5%a2%83%e3%81%a7%e5%8b%95%e4%bd%9c%e7%a2%ba%e8%aa%8d aria-label=Anchor>#</a></span></h4><p>AWS 上へデプロイする前にローカル環境で軽く動作をしたい場合は、<code>chalice local</code> コマンドを実行します。
実行例のように期待通りのレスポンスが返ってくるようであれば、いよいよ AWS 上へデプロイをしていきましょう。</p><p><strong>実行例）Tarminal#1から実行</strong></p><pre tabindex=0><code class=language-bash:Termina1 data-lang=bash:Termina1>$ chalice local
Serving on http://127.0.0.1:8000
</code></pre><p><strong>実行例）Tarminal#2から実行</strong></p><pre tabindex=0><code class=language-bash:Terminal2 data-lang=bash:Terminal2>$ curl http://127.0.0.1:8000/hello
{&#34;hello&#34;:&#34;world&#34;}
$ curl -X POST -H &#34;Content-Type: application/json&#34; -d &#39;{&#34;payload&#34;:&#34;hello, world&#34;}&#39; http://127.0.0.1:8000/hello
{&#34;result&#34;:&#34;hello, world&#34;}
</code></pre><h4 id=step4-aws-上へデプロイ class="relative group">Step4. AWS 上へデプロイ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#step4-aws-%e4%b8%8a%e3%81%b8%e3%83%87%e3%83%97%e3%83%ad%e3%82%a4 aria-label=Anchor>#</a></span></h4><p>AWS 上へアプリケーションのデプロイをする場合は、<code>chalice deploy</code> コマンドを実行します。実行例ではメッセージから新たに Lambda 関数、API Gateway と IAM ロールが作られていることがわかります。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ chalice deploy --stage dev
</span></span><span class=line><span class=cl>Creating deployment package.
</span></span><span class=line><span class=cl>Creating IAM role: &lt;任意のプロジェクト名&gt;-dev
</span></span><span class=line><span class=cl>Creating lambda <span class=k>function</span>: &lt;任意のプロジェクト名&gt;-dev
</span></span><span class=line><span class=cl>Creating Rest API
</span></span><span class=line><span class=cl>Resources deployed:
</span></span><span class=line><span class=cl>  - Lambda ARN: arn:aws:lambda:ap-northeast-1:&lt;AWSアカウント名&gt;:function:&lt;任意のプロジェクト名&gt;-dev
</span></span><span class=line><span class=cl>  - Rest API URL: https://&lt;文字列&gt;.execute-api.ap-northeast-1.amazonaws.com/api/
</span></span></code></pre></div><p>デプロイ完了後は期待するレスポンスが返ってくるか確認しましょう。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl https://&lt;文字列&gt;.execute-api.ap-northeast-1.amazonaws.com/api/hello
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;hello&#34;</span>:<span class=s2>&#34;world&#34;</span><span class=o>}</span>
</span></span><span class=line><span class=cl>$ curl -X POST -H <span class=s2>&#34;Content-Type: application/json&#34;</span> -d <span class=s1>&#39;{&#34;payload&#34;:&#34;hello, world&#34;}&#39;</span> https://&lt;文字列&gt;.execute-api.ap-northeast-1.amazonaws.com/api/hello
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;result&#34;</span>:<span class=s2>&#34;hello, world&#34;</span><span class=o>}</span>
</span></span></code></pre></div><p>以上、AWS Chalice を使ったアプリケーションの作成からデプロイまでの一連の流れでした。</p><h4 id=stepex-デプロイしたアプリケーションの削除 class="relative group">StepEX. デプロイしたアプリケーションの削除 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#stepex-%e3%83%87%e3%83%97%e3%83%ad%e3%82%a4%e3%81%97%e3%81%9f%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%81%ae%e5%89%8a%e9%99%a4 aria-label=Anchor>#</a></span></h4><p>不要になったアプリケーションは <code>chalice delete</code> コマンドを使って削除しておきましょう。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ chalice delete
</span></span><span class=line><span class=cl>Deleting Rest API: &lt;文字列&gt;
</span></span><span class=line><span class=cl>Deleting <span class=k>function</span>: arn:aws:lambda:ap-northeast-1:&lt;AWSアカウント名&gt;:function:&lt;任意のプロジェクト名&gt;-dev
</span></span><span class=line><span class=cl>Deleting IAM role: &lt;任意のプロジェクト名&gt;-dev
</span></span></code></pre></div><h3 id=ユニットテストを自動化しよう class="relative group">ユニットテストを自動化しよう <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e3%83%a6%e3%83%8b%e3%83%83%e3%83%88%e3%83%86%e3%82%b9%e3%83%88%e3%82%92%e8%87%aa%e5%8b%95%e5%8c%96%e3%81%97%e3%82%88%e3%81%86 aria-label=Anchor>#</a></span></h3><p>近頃はユニットテストの自動化は一般的に行われているかと思います。AWS Chalice でも Python の一般的なテストツール Pytest を使ってユニットテストを実装できます。例として、今回は次のサンプルに対するテストコードを実装してみます。</p><p><strong>作成例）app.py(テスト対象のプログラム)</strong></p><pre tabindex=0><code class=language-python:app.py(テスト対象のプログラム) data-lang=python:app.py(テスト対象のプログラム)>from chalice import Chalice

app = Chalice(app_name=&#39;&lt;任意のプロジェクト名&gt;&#39;)
app.log.setLevel(logging.INFO)

@app.route(&#39;/hello&#39;)
def hello():
    app.log.debug(&#34;Invoking from function hello&#34;)
    return {&#39;hello&#39;: &#39;world&#39;}

@app.route(&#39;/hello&#39;, methods=[&#39;POST&#39;], content_types=[&#39;application/json&#39;], cors=True)
def hello_post():
    app.log.debug(&#34;Invoking from function hello_post&#34;)
    request = app.current_request
    return {&#39;result&#39;: request.json_body[&#39;payload&#39;]}
</code></pre><h4 id=step1-テストコードの実装 class="relative group">Step1. テストコードの実装 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#step1-%e3%83%86%e3%82%b9%e3%83%88%e3%82%b3%e3%83%bc%e3%83%89%e3%81%ae%e5%ae%9f%e8%a3%85 aria-label=Anchor>#</a></span></h4><p>では、まず必要なファイルを用意していきましょう。中身は後で入れるとしてここでは空ファイルだけ作ります。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ touch test_requirements.txt    <span class=c1># テストプログラムの依存ライブラリ定義</span>
</span></span><span class=line><span class=cl>$ mkdir tests
</span></span><span class=line><span class=cl>$ touch tests/__init__.py
</span></span><span class=line><span class=cl>$ touch tests/conftest.py        <span class=c1># テストプログラム間で共通の処理を実装</span>
</span></span><span class=line><span class=cl>$ touch tests/test_app.py        <span class=c1># テストプログラムを実装</span>
</span></span></code></pre></div><p>次に各ファイルを編集していきましょう。今回は HTTP レスポンスのステータスコードとボディの中身を確認するだけの簡単なテストプログラムを用意しました。</p><p><strong>作成例）test_requirements.txt（依存ライブラリの定義）</strong></p><pre tabindex=0><code class=language-text:test_requirements.txt（依存ライブラリの定義） data-lang=text:test_requirements.txt（依存ライブラリの定義）>pytest-chalice
pytest-cov
</code></pre><p><strong>作成例）tests/<strong>init</strong>.py</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python:tests/__init__.py data-lang=python:tests/__init__.py><span class=line><span class=cl><span class=p>(</span><span class=n>EOF</span><span class=p>)</span>
</span></span></code></pre></div><p><strong>作成例）tests/conftest.py（共通処理の実装）</strong></p><pre tabindex=0><code class=language-python:tests/conftest.py（共通処理の実装） data-lang=python:tests/conftest.py（共通処理の実装）>import pytest
from app import app as chalice_app

@pytest.fixture
def app():
	return chalice_app
</code></pre><p><strong>作成例）tests/test_app.py（テストの実装）</strong></p><pre tabindex=0><code class=language-python:tests/test_app.py（テストの実装） data-lang=python:tests/test_app.py（テストの実装）>from http import HTTPStatus
import json

def test_hello_get(client):
    response = client.get(&#39;/hello&#39;)
    assert response.status_code == HTTPStatus.OK
    assert response.json == {&#39;hello&#39;: &#39;world&#39;}

def test_hello_post(client):
    headers = {&#39;Content-type&#39;:&#39;application/json&#39;}
    payload = {&#39;payload&#39;:&#39;hello, world&#39;}
    response = client.post(&#39;/hello&#39;, headers=headers, body=json.dumps(payload))
    assert response.status_code == HTTPStatus.OK
    assert response.json == {&#39;result&#39;: &#39;hello, world&#39;}

def test_hello_put(client):
    response = client.put(&#39;/hello&#39;)
    assert response.status_code == HTTPStatus.METHOD_NOT_ALLOWED
    assert response.json == {&#34;Code&#34;:&#34;MethodNotAllowedError&#34;,&#34;Message&#34;:&#34;Unsupported method: PUT&#34;}
</code></pre><h4 id=step2-ユニットテストの実行 class="relative group">Step2. ユニットテストの実行 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#step2-%e3%83%a6%e3%83%8b%e3%83%83%e3%83%88%e3%83%86%e3%82%b9%e3%83%88%e3%81%ae%e5%ae%9f%e8%a1%8c aria-label=Anchor>#</a></span></h4><p>ではテストプログラムが用意できたので <code>pytest</code> コマンドを使ってユニットテストを実行しましょう。実行例では、出力メッセージからユニットテスト 3 件が実行され、3 件とも成功 (PASSED) して、C1 カバレッジが 100% 網羅されていることがわかります。</p><p><strong>実行例）</strong></p><pre tabindex=0><code class=language-bash:テストの実行 data-lang=bash:テストの実行>$ python3 -m pip install -r test_requirements.txt
$ pytest -v --cov --cov-branch
=========================== test session starts ============================
platform linux -- Python 3.7.10, pytest-6.2.5, py-1.10.0, pluggy-1.0.0 -- /home/cloudshell-user/venv37/bin/python3
cachedir: .pytest_cache
rootdir: /home/cloudshell-user/&lt;任意のプロジェクト名&gt;
plugins: cov-3.0.0, chalice-0.0.5
collected 3 items

tests/test_app.py::test_hello_get PASSED                             [ 33%]
tests/test_app.py::test_hello_post PASSED                            [ 66%]
tests/test_app.py::test_hello_put PASSED                             [100%]

---------- coverage: platform linux, python 3.7.10-final-0 -----------
Name                Stmts   Miss Branch BrPart  Cover
-----------------------------------------------------
app.py                 11      0      0      0   100%
tests/__init__.py       0      0      0      0   100%
tests/conftest.py       4      0      0      0   100%
tests/test_app.py      16      0      0      0   100%
-----------------------------------------------------
TOTAL                  31      0      0      0   100%

============================ 3 passed in 0.05s =============================
</code></pre><p>以上、ちょっとしたユニットテストの自動化のご紹介でした。</p><h3 id=cicd-パイプラインを構築しよう class="relative group">CI/CD パイプラインを構築しよう <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#cicd-%e3%83%91%e3%82%a4%e3%83%97%e3%83%a9%e3%82%a4%e3%83%b3%e3%82%92%e6%a7%8b%e7%af%89%e3%81%97%e3%82%88%e3%81%86 aria-label=Anchor>#</a></span></h3><p>次はもう一歩進んで、ソースコードの更新をトリガーに自動でテストを実行してデプロイまで実施する CI/CD パイプラインを構築し、実際に動かすところまで行ってみたいと思います。</p><h4 id=step1-cicd-パイプラインの作成 class="relative group">Step1. CI/CD パイプラインの作成 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#step1-cicd-%e3%83%91%e3%82%a4%e3%83%97%e3%83%a9%e3%82%a4%e3%83%b3%e3%81%ae%e4%bd%9c%e6%88%90 aria-label=Anchor>#</a></span></h4><p>AWS Chalice には CI/CD パイプライン用の CloudFormation(CFn) テンプレートを自動生成してくれるとても便利な <code>chalice generate-pipeline</code> コマンドがあります。今回の例では、先ほど作ったユニットテストもパイプラインの中で実行するようにしますので、buildspec.yml を分離する <code>-b</code> オプションも付与して実行します。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ chalice generate-pipeline -b buildspec.yml &lt;テンプレートファイル名&gt;
</span></span></code></pre></div><p>作成された CFn テンプレートは中身が大きいのでここには貼り付けませんが、おおよそ次のような AWS リソース作成が定義されています。</p><ul><li>AWS CodeCommit リポジトリ</li><li>AWS CodeBuild プロジェクト</li><li>AWS CodePipeline パイプライン</li><li>Amazon Simple Storage Service(S3) バケット</li><li>AWS IAM ロールおよびポリシー</li></ul><p>なお、今回はユニットテストの結果をレポート出力できるように作成されたテンプレートファイルを編集して CodeBuild に割り当てる権限を追加しました。</p><p><strong>作成例）CFnテンプレート（編集後）</strong></p><pre tabindex=0><code class=language-diff:CFnテンプレート（編集後） data-lang=diff:CFnテンプレート（編集後）>    &#34;CodeBuildPolicy&#34;: {
      &#34;Type&#34;: &#34;AWS::IAM::Policy&#34;,
      &#34;Properties&#34;: {
        &#34;PolicyName&#34;: &#34;CodeBuildPolicy&#34;,
        &#34;PolicyDocument&#34;: {
          &#34;Version&#34;: &#34;2012-10-17&#34;,
          &#34;Statement&#34;: [
            {
+             &#34;Action&#34;: [
+               &#34;codebuild:CreateReportGroup&#34;,
+               &#34;codebuild:CreateReport&#34;,
+               &#34;codebuild:UpdateReport&#34;,
+               &#34;codebuild:BatchPutTestCases&#34;,
+               &#34;codebuild:BatchPutCodeCoverages&#34;
+             ],
+             &#34;Resource&#34;: &#34;*&#34;,
+             &#34;Effect&#34;: &#34;Allow&#34;
+           },
            {
              &#34;Action&#34;: [
</code></pre><p>では CFn テンプレートからリソースをデプロイしましょう。実行例のようにスタック作成の成功と出力されたら完了です。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ aws cloudformation deploy --stack-name &lt;スタック名&gt; --template-file &lt;テンプレートファイル名&gt; --capabilities CAPABILITY_IAM
</span></span><span class=line><span class=cl>:
</span></span><span class=line><span class=cl>Successfully created/updated stack - &lt;スタック名&gt;
</span></span></code></pre></div><h4 id=step2-パイプラインジョブ定義の編集 class="relative group">Step2. パイプラインジョブ定義の編集 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#step2-%e3%83%91%e3%82%a4%e3%83%97%e3%83%a9%e3%82%a4%e3%83%b3%e3%82%b8%e3%83%a7%e3%83%96%e5%ae%9a%e7%be%a9%e3%81%ae%e7%b7%a8%e9%9b%86 aria-label=Anchor>#</a></span></h4><p>次に <code>chalice generate-pipeline</code> で生成されたパイプラインジョブの定義を編集して、ユニットテストも自動で実行するようにしていきましょう。編集前のファイル内容はこちらです。</p><p><strong>作成例）buildspec.yml（編集前）</strong></p><pre tabindex=0><code class=language-yaml:buildspec.yml（編集前） data-lang=yaml:buildspec.yml（編集前）>artifacts:
  files:
  - transformed.yaml
  type: zip
phases:
  install:
    commands:
    - sudo pip install --upgrade awscli
    - aws --version
    - sudo pip install &#39;chalice&gt;=1.26.0,&lt;1.27.0&#39;
    - sudo pip install -r requirements.txt
    - chalice package /tmp/packaged
    - aws cloudformation package --template-file /tmp/packaged/sam.json --s3-bucket
      ${APP_S3_BUCKET} --output-template-file transformed.yaml
version: &#39;0.1&#39;
</code></pre><p>編集後のファイルは次のようにしてみました。記載順序の入れ替えやビルドフェーズの分割も併せて実施していてわかりにくくなっていますが、要約すると test_requirements.txt の読み込みと pytest コマンドの実行をステップとして追加しています。</p><p><strong>作成例）buildspec.yml（編集後）</strong></p><pre tabindex=0><code class=language-yaml:buildspec.yml（編集後） data-lang=yaml:buildspec.yml（編集後）>version: 0.2
phases:
  install:
    commands:
    - python --version
  pre_build:
    commands:
    - sudo pip install --upgrade awscli pip
    - aws --version
    - sudo pip install -r requirements.txt -r test_requirements.txt
  build:
    commands:
    - pytest -v -junit-xml=test-result.xml --cov --cov-branch --cov-report=xml --cov-report=term
  post_build:
    commands:
    - chalice package /tmp/packaged
    - aws cloudformation package --template-file /tmp/packaged/sam.json --s3-bucket
      ${APP_S3_BUCKET} --output-template-file transformed.yaml
reports:
  pytest_reports:
    files:
      - test-result.xml
    file-format: JUNITXML
  cobertura_reports:
    files:
      - coverage.xml
    file-format: COBERTURAXML
artifacts:
  files:
  - transformed.yaml
</code></pre><h4 id=step3-cicd-パイプラインの動作確認 class="relative group">Step3. CI/CD パイプラインの動作確認 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#step3-cicd-%e3%83%91%e3%82%a4%e3%83%97%e3%83%a9%e3%82%a4%e3%83%b3%e3%81%ae%e5%8b%95%e4%bd%9c%e7%a2%ba%e8%aa%8d aria-label=Anchor>#</a></span></h4><p>環境もパイプラインジョブの定義も整いましたので、あとは作成された CodeCommit リポジトリへソースコードを登録して、それをトリガーに自動でパイプラインが実行されるところまで見ていきましょう。</p><p>まずはローカルに git リポジトリを作成して、ソースコードのコミットまでしていきましょう。今回の <code>.gitignore</code> ファイルは GitHub さんが公開する Python 向けテンプレートを使ってます。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git init .
</span></span><span class=line><span class=cl>$ curl https://raw.githubusercontent.com/github/gitignore/master/Python.gitignore &gt; .gitignore
</span></span><span class=line><span class=cl>$ git add .
</span></span><span class=line><span class=cl>$ git commit -m <span class=s2>&#34;Initial commit&#34;</span>
</span></span></code></pre></div><p>次に、ソースコードを格納する AWS CodeCommit リポジトリの URL を確認します。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ aws cloudformation describe-stacks --stack-name &lt;スタック名&gt; --query <span class=s1>&#39;Stacks[0].Outputs&#39;</span>
</span></span><span class=line><span class=cl>:
</span></span><span class=line><span class=cl>- OutputKey: SourceRepoURL
</span></span><span class=line><span class=cl>  OutputValue: https://git-codecommit.ap-northeast-1.amazonaws.com/v1/repos/&lt;プロジェクト名&gt;
</span></span><span class=line><span class=cl>:
</span></span></code></pre></div><p>先ほど調べたリポジトリ情報を元に、リモートリポジトリを追加します。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git remote add codecommit https://git-codecommit.ap-northeast-1.amazonaws.com/v1/repos/&lt;プロジェクト名&gt;
</span></span></code></pre></div><p>CodeCommit へ Push できるように認証情報ヘルパーを設定します。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git config --global credential.helper <span class=s1>&#39;!aws codecommit credential-helper $@&#39;</span>
</span></span><span class=line><span class=cl>$ git config --global credential.UseHttpPath <span class=nb>true</span>
</span></span></code></pre></div><p>ではソースコードをリモートレポジトリへ push してみましょう。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git push codecommit master
</span></span></code></pre></div><p>さてここからは AWS マネジメントコンソールに移ります。先ほどの <code>git push</code> をトリガーにパイプラインが起動していることを確認するためまずは CodePipeline 画面へ。次のように CI/CD パイプラインが動作していることが確認できるかと思います。</p><p><figure><img class="my-0 rounded-md" srcset="/posts/2021/10/aws-chalice/images/02-codepipeline_build_huca0b768bad31e1ce87088475bd85a5b8_56598_330x0_resize_box_3.png 330w,
/posts/2021/10/aws-chalice/images/02-codepipeline_build_huca0b768bad31e1ce87088475bd85a5b8_56598_660x0_resize_box_3.png 660w,
/posts/2021/10/aws-chalice/images/02-codepipeline_build_huca0b768bad31e1ce87088475bd85a5b8_56598_1024x0_resize_box_3.png 1024w,
/posts/2021/10/aws-chalice/images/02-codepipeline_build_huca0b768bad31e1ce87088475bd85a5b8_56598_1320x0_resize_box_3.png 2x" src=/posts/2021/10/aws-chalice/images/02-codepipeline_build_huca0b768bad31e1ce87088475bd85a5b8_56598_660x0_resize_box_3.png alt=02-codepipeline_build.png></figure></p><p>では次に、ビルド処理に追加したユニットテストが動いているかを確認しましょう。Build ステージの CodeBuild アクションボックスの「成功しました」メッセージのすぐ下にある「詳細」ボタンをクリックして CodeBuild 画面へ進みましょう。次のようにビルドログからユニットテストが実行されていることが確認できるかと思います。</p><p><figure><img class="my-0 rounded-md" srcset="/posts/2021/10/aws-chalice/images/03-codebuild_hub640ac7a14ea549b3c38b7db8bf1c432_39698_330x0_resize_box_3.png 330w,
/posts/2021/10/aws-chalice/images/03-codebuild_hub640ac7a14ea549b3c38b7db8bf1c432_39698_660x0_resize_box_3.png 660w,
/posts/2021/10/aws-chalice/images/03-codebuild_hub640ac7a14ea549b3c38b7db8bf1c432_39698_1024x0_resize_box_3.png 1024w,
/posts/2021/10/aws-chalice/images/03-codebuild_hub640ac7a14ea549b3c38b7db8bf1c432_39698_1320x0_resize_box_3.png 2x" src=/posts/2021/10/aws-chalice/images/03-codebuild_hub640ac7a14ea549b3c38b7db8bf1c432_39698_660x0_resize_box_3.png alt=03-codebuild.png></figure></p><p>また、テストとカバレッジのレポートについてはレポートグループの方にも登録されていることが確認できるかと思います。</p><p><figure><img class="my-0 rounded-md" srcset="/posts/2021/10/aws-chalice/images/04-codbuild-report_hubf0b91e21d4433600e75fb0ea9b09824_28330_330x0_resize_box_3.png 330w,
/posts/2021/10/aws-chalice/images/04-codbuild-report_hubf0b91e21d4433600e75fb0ea9b09824_28330_660x0_resize_box_3.png 660w,
/posts/2021/10/aws-chalice/images/04-codbuild-report_hubf0b91e21d4433600e75fb0ea9b09824_28330_1024x0_resize_box_3.png 1024w,
/posts/2021/10/aws-chalice/images/04-codbuild-report_hubf0b91e21d4433600e75fb0ea9b09824_28330_1320x0_resize_box_3.png 2x" src=/posts/2021/10/aws-chalice/images/04-codbuild-report_hubf0b91e21d4433600e75fb0ea9b09824_28330_660x0_resize_box_3.png alt=04-codbuild-report.png></figure></p><p>では CodePipeline 画面へ戻りましょう。Beta ステージで実施しているアプリケーションのデプロイにも成功していることがわかりますね。ExcecuteChangeSet アクションボックスの「詳細」ボタンをクリックし、CloudFormation 画面へ進みましょう。</p><p><figure><img class="my-0 rounded-md" srcset="/posts/2021/10/aws-chalice/images/05-codepipeline_deploy_hu3fe24fa5acee2273c07a49d1041a6766_50846_330x0_resize_box_3.png 330w,
/posts/2021/10/aws-chalice/images/05-codepipeline_deploy_hu3fe24fa5acee2273c07a49d1041a6766_50846_660x0_resize_box_3.png 660w,
/posts/2021/10/aws-chalice/images/05-codepipeline_deploy_hu3fe24fa5acee2273c07a49d1041a6766_50846_1024x0_resize_box_3.png 1024w,
/posts/2021/10/aws-chalice/images/05-codepipeline_deploy_hu3fe24fa5acee2273c07a49d1041a6766_50846_1320x0_resize_box_3.png 2x" src=/posts/2021/10/aws-chalice/images/05-codepipeline_deploy_hu3fe24fa5acee2273c07a49d1041a6766_50846_660x0_resize_box_3.png alt=05-codepipeline_deploy.png></figure></p><p>CloudFormation 画面では出力の一覧から EndpointURL 値を確認しましょう。</p><p><figure><img class="my-0 rounded-md" srcset="/posts/2021/10/aws-chalice/images/06-stack_hue4683132d2838855577df76962003e1b_41532_330x0_resize_box_3.png 330w,
/posts/2021/10/aws-chalice/images/06-stack_hue4683132d2838855577df76962003e1b_41532_660x0_resize_box_3.png 660w,
/posts/2021/10/aws-chalice/images/06-stack_hue4683132d2838855577df76962003e1b_41532_1024x0_resize_box_3.png 1024w,
/posts/2021/10/aws-chalice/images/06-stack_hue4683132d2838855577df76962003e1b_41532_1320x0_resize_box_3.png 2x" src=/posts/2021/10/aws-chalice/images/06-stack_hue4683132d2838855577df76962003e1b_41532_660x0_resize_box_3.png alt=06-stack.png></figure></p><p>最後に、期待するレスポンスが返ってくるか生成された EndpointURL に向けて HTTP リクエストを発行して確認しましょう。実行例では期待するレスポンスが返ってきてますね。</p><p><strong>実行例）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ curl https://&lt;文字列&gt;.execute-api.ap-northeast-1.amazonaws.com/api/hello
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;hello&#34;</span>:<span class=s2>&#34;world&#34;</span><span class=o>}</span>
</span></span><span class=line><span class=cl>$ curl -X POST -H <span class=s2>&#34;Content-Type: application/json&#34;</span> -d <span class=s1>&#39;{&#34;payload&#34;:&#34;hello, world&#34;}&#39;</span> https://&lt;文字列&gt;.execute-api.ap-northeast-1.amazonaws.com/api/hello
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;result&#34;</span>:<span class=s2>&#34;hello, world&#34;</span><span class=o>}</span>
</span></span></code></pre></div><p>本来はもっとパイプラインに条件分岐を持たせたりすると思いますが、ひとまずこれでソースコードのプッシュを契機にテストを走らせてからデプロイを行う、という最低限の流れを自動化することができました。</p><p>以上、ちょっとした CI/CD パイプラインの作成でした。</p><h2 id=ちゃんとしたアプリケーションを開発するには class="relative group">ちゃんとしたアプリケーションを開発するには <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e3%81%a1%e3%82%83%e3%82%93%e3%81%a8%e3%81%97%e3%81%9f%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%82%92%e9%96%8b%e7%99%ba%e3%81%99%e3%82%8b%e3%81%ab%e3%81%af aria-label=Anchor>#</a></span></h2><h3 id=公式ドキュメントを活用しよう class="relative group">公式ドキュメントを活用しよう <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e5%85%ac%e5%bc%8f%e3%83%89%e3%82%ad%e3%83%a5%e3%83%a1%e3%83%b3%e3%83%88%e3%82%92%e6%b4%bb%e7%94%a8%e3%81%97%e3%82%88%e3%81%86 aria-label=Anchor>#</a></span></h3><p>ちゃんとしたアプリケーションにするにはもちろん色々と機能を実装しないといけませんよね。こんなときにいつも私がお世話になっているのが公式ドキュメントです。トピックごとに簡単なサンプルを交えた実装方法について記載がありますのでとても参考になるかと思います。</p><iframe class=hatenablogcard style=width:100%;height:155px;max-width:680px src="https://hatenablog-parts.com/embed?url=https://aws.github.io/chalice/main.html" frameborder=0 scrolling=no></iframe><h3 id=サービス別資料を参考にしよう class="relative group">サービス別資料を参考にしよう <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e3%82%b5%e3%83%bc%e3%83%93%e3%82%b9%e5%88%a5%e8%b3%87%e6%96%99%e3%82%92%e5%8f%82%e8%80%83%e3%81%ab%e3%81%97%e3%82%88%e3%81%86 aria-label=Anchor>#</a></span></h3><p>もちろん AWS さんのサービス別資料もとても参考になります。こちらも目を通していただけると良いかと思います。</p><iframe src=//www.slideshare.net/slideshow/embed_code/key/pGaZHnM6sdX72n width=595 height=485 frameborder=0 marginwidth=0 marginheight=0 scrolling=no style="border:1px solid #ccc;border-width:1px;margin-bottom:5px;max-width:100%" allowfullscreen></iframe><h2 id=余談ですが class="relative group">余談ですが、、、 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e4%bd%99%e8%ab%87%e3%81%a7%e3%81%99%e3%81%8c aria-label=Anchor>#</a></span></h2><p>本記事執筆のきっかけとなった AWS Summit Online Japan 2021 で行った日立の講演についてもご紹介させてください。</p><p>この講演では、IoT やサーバレス技術を活用した異なるタイプ(データ分析系とアプリケーション開発系)の事例を 1 件ずつお話させていただきました。AWS Chalice については、2 つ目のアプリケーション開発系の事例にて本当に軽くですが触れておりますのでよろしければご参照いただけると幸いです。</p><p>この講演を通じて「ほほう、日立ってこんなこともしてたんだ」と多少なりとも良いイメージを抱いてもらえるきっかけになってくれると嬉しいなと思ってます σ(,,´∀ ｀,,)</p><iframe width=560 height=315 src=https://www.youtube.com/embed/LLi1lzhpoto title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><h2 id=終わりに class="relative group">終わりに <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%e7%b5%82%e3%82%8f%e3%82%8a%e3%81%ab aria-label=Anchor>#</a></span></h2><p>AWS Chalice はいかがだったでしょうか？</p><p>AWS には、AWS SAM (Serverless Application Model)といった別のサーバレスアプリケーション開発用フレームワークがありますが、こちらと比較すると機能がかなり限定されることもあって、今回ご紹介した AWS Chalice は多くの方にとって馴染みもなければ、なかなかに触れる機会も少ないのかもしれません。</p><p>ただ、実際に触ってみていただけばわかる通り、とても簡単・手軽にサーバレスアプリケーションを作ることができますので、迅速性を求められる PoC(概念実証)や PoV(価値実証)といった場面でとくに有用なのでは、と考えています。気になった方はぜひ触ってみて、そのお手軽さを実際に体験していただければと思います。</p><p>以上、AWS 上でサーバレスアプリケーションを手軽に開発できるようにする「AWS Chalice」のご紹介でした。</p><hr><ul><li>AWS は、米国その他の諸国における Amazon.com, Inc. またはその関連会社の商標です。</li><li>その他、本資料に記述してある会社名、製品名は、各社の登録商品または商標です。</li></ul></div></section><footer class="pt-8 max-w-prose"><div class=flex><img class="w-24 h-24 !mt-0 !mb-0 ltr:mr-4 rtl:ml-4 rounded-full" width=96 height=96 alt=Author src=/images/author_hue15be1a1f1f7746f75b991c8c139eb81_544064_192x192_fill_q75_box_smart1.jpg><div class=place-self-center><div class="text-[0.6rem] leading-3 text-neutral-500 dark:text-neutral-400 uppercase">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">クラウドCoEの何でも屋</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Cloud Architect, 12x AWS, 6x Azure, 3x GCP Certifications Engineer<br>好きなモノ = 真っ赤なスポーツカー + ロックミュージック、趣味 = 投資 + 仕事</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/chacco38 target=_blank aria-label=Github rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/chacco38 target=_blank aria-label=Twitter rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.facebook.com/satoshi.matsuzawa.9 target=_blank aria-label=Facebook rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/satoshi-matsuzawa-b209a1157 target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a></div></div></div></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1" href="https://www.facebook.com/sharer/sharer.php?u=https://chacco38.github.io/posts/2021/10/aws-chalice/&quote=AWS%20Chalice%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%82%b5%e3%83%bc%e3%83%90%e3%83%ac%e3%82%b9%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%82%92%e9%96%8b%e7%99%ba%e3%81%97%e3%82%88%e3%81%86" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></span></a><a class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1" href="https://twitter.com/intent/tweet/?url=https://chacco38.github.io/posts/2021/10/aws-chalice/&text=AWS%20Chalice%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%82%b5%e3%83%bc%e3%83%90%e3%83%ac%e3%82%b9%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%82%92%e9%96%8b%e7%99%ba%e3%81%97%e3%82%88%e3%81%86" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></a><a class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1" href="https://pinterest.com/pin/create/bookmarklet/?url=https://chacco38.github.io/posts/2021/10/aws-chalice/&description=AWS%20Chalice%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%82%b5%e3%83%bc%e3%83%90%e3%83%ac%e3%82%b9%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%82%92%e9%96%8b%e7%99%ba%e3%81%97%e3%82%88%e3%81%86" title="Pin on Pinterest" aria-label="Pin on Pinterest"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg></span></a><a class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1" href="https://reddit.com/submit/?url=https://chacco38.github.io/posts/2021/10/aws-chalice/&resubmit=true&title=AWS%20Chalice%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%82%b5%e3%83%bc%e3%83%90%e3%83%ac%e3%82%b9%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%82%92%e9%96%8b%e7%99%ba%e3%81%97%e3%82%88%e3%81%86" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></span></a><a class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1" href="https://www.linkedin.com/shareArticle?mini=true&url=https://chacco38.github.io/posts/2021/10/aws-chalice/&title=AWS%20Chalice%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%82%b5%e3%83%bc%e3%83%90%e3%83%ac%e3%82%b9%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%82%92%e9%96%8b%e7%99%ba%e3%81%97%e3%82%88%e3%81%86" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a><a class="bg-neutral-300 text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800 m-1 hover:bg-primary-500 hover:text-neutral rounded min-w-[2.4rem] inline-block text-center p-1" href="mailto:?body=https://chacco38.github.io/posts/2021/10/aws-chalice/&subject=AWS%20Chalice%e3%82%92%e4%bd%bf%e3%81%a3%e3%81%a6%e3%82%b5%e3%83%bc%e3%83%90%e3%83%ac%e3%82%b9%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%82%92%e9%96%8b%e7%99%ba%e3%81%97%e3%82%88%e3%81%86" title="Send via email" aria-label="Send via email"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></section><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group" href=/posts/2021/06/azure-data-scientist-associate-dp-100-exam/><span class="mr-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Microsoft 認定 Azure Data Scientist Associate (DP-100) 受験メモ</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2021-06-05 00:00:00 +0900 +0900">June 5, 2021</time></span></span></a></span>
<span><a class="flex text-right group" href=/posts/2021/10/aws-taskcat/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">TaskCatを使ってCloudFormationテンプレートの自動テストをしよう</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2021-10-20 00:00:00 +0900 +0900">October 20, 2021</time></span></span>
<span class="ml-3 ltr:inline rtl:hidden text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 ltr:hidden rtl:inline text-neutral-700 dark:text-neutral group-hover:text-primary-600 dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div class="absolute top-[110vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-[-5.5rem]"><a href=#the-top class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><div id=search-wrapper class="fixed inset-0 z-50 flex flex-col p-4 sm:p-6 md:p-[10vh] lg:p-[12vh] w-screen h-screen cursor-default bg-neutral-500/50 backdrop-blur-sm dark:bg-neutral-900/50 invisible" data-url=https://chacco38.github.io/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg border-neutral-200 top-20 bg-neutral dark:bg-neutral-800 dark:border-neutral-700"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative inline-block align-text-bottom icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-transparent focus:outline-2" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div><footer class=py-10><div class="flex justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2022
クラウドCoEの何でも屋</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="text-sm cursor-pointer text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-14 rtl:ml-14"><button id=appearance-switcher class="w-12 h-12" type=button title="Switch to dark appearance">
<span class="inline dark:hidden"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></span><span class="hidden dark:inline"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></span></button></div></div></footer></body></html>